define(["require","jquery","layer","app/tplEngine"],function(a,b,c,d){function g(a){var b=new Blob([""],{type:"application/octet-stream"}),c=URL.createObjectURL(b),d=document.createElement("a");d.href=a,d.download=a.replace(/(.*\/)*([^.]+.*)/ig,"$2").split("?")[0];var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),d.dispatchEvent(e),URL.revokeObjectURL(c)}function h(){var a=navigator.userAgent.toLowerCase();return/iphone|ipad|ipod/.test(a)?!0:!1}function i(){var a=window.navigator.userAgent.toLowerCase();return a.match(/MicroMessenger/i)=="micromessenger"?!0:!1}function j(a){a.close=a.close||function(){},f=a.image||f;var j='<div class="attention-wrap">\n        <div class="close" data-attention><img src="'+e+'"/></div>\n'+'        <div class="ft16 mb10"><%= title %></div>\n'+"        <div>\n"+'            <div class="ft12"><%= content %></div>\n'+'            <div class="attention-erweima">\n'+'                <img style="display: block;margin: auto;width: 85%;" src="'+f+'"/>\n'+"            </div>\n"+"        </div>\n"+"    </div>",k={content:d.init(j,{title:a.title,content:a.content}),skin:"attention",shadeClose:!1,success:function(d){b(d).find("[data-attention]").click(function(){c.close(l),a.close()})}};!i()&&!h()&&(k.btn="保存二维码至手机",k.yes=function(){g(f)});var l=c.open(k)}var e=a.toUrl("../../style/ext_img/close_64.svg"),f=a.toUrl("../../style/ext_img/qrcode_for_gh_f6020f09743b_430.jpg");return{saveAs:g,loadErweima:j,isWeixin:i,isIos:h}})