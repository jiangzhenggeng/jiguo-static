define(["jquery","app/login"],function(a,b){return{init:function(){a("body").on("click","[data-zan]",function(){if(!window.URL.login)return b.login(),!1;var c=a(this),d=c.attr("data-id"),e=c.attr("data-add-praiselist");c.hasClass("zan-on")||a.post("/api/praise/praise",{id_value:d,type:3},function(d){if(d.resultCode==0)if(d.result.zan==1){c.addClass("zan-on").find("i").addClass("on animate");var f=parseInt(c.find("[data-praise-num]").text()||0)+1,g=parseInt(c.find("[data-praise-every]").text()||0)+1,h=a("body").find("[data-praise-num]");h.each(function(b){a(h[b]).text(f)}),c.find("[data-praise-every]").text(g),setTimeout(function(){c.addClass("zan-on").find("i").removeClass("animate")},700);if(e){var i=""+d.result.avatar+"/230x230",j="<li><img src="+i+"></li>",k=a("#praise-list");k.find("li").length?k.find("li").first().before(j):(a("#praise-list-box").removeClass("none"),k.append(j))}}else c.removeClass("zan-on").find("i").removeClass("on");else d.resultCode==-100?b.login():layer.msg("操作失败~请稍后再试")},"json")})}}})