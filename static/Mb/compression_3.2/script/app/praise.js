define(["jquery","app/login","layer"],function(a,b,c){return{init:function(){a("body").on("click","[data-zan]",function(){var d;if(d)return!1;d=!0;if(!window.URL.login)return b.login(),!1;var e=a(this),f=e.attr("data-id"),g=e.attr("data-add-praiselist");e.hasClass("zan-on")||a.post("/api/praise/praise",{id_value:f,type:3},function(f){if(f.resultCode==0){d=!1;if(f.result.zan==1){e.addClass("zan-on").find("i").addClass("on animate");var h=parseInt(e.find("[data-praise-num]").text()||0)+1,i=parseInt(e.find("[data-praise-every]").text()||0)+1,j=a("body").find("[data-praise-num]");j.each(function(b){a(j[b]).text(h)}),e.find("[data-praise-every]").text(i),setTimeout(function(){e.addClass("zan-on").find("i").removeClass("animate")},700);if(g){var k=""+f.result.avatar+"/230x230",l="<li><img src="+k+"></li>",m=a("#praise-list");m.find("li").length?m.find("li").first().before(l):(a("#praise-list-box").removeClass("none"),m.append(l))}}else e.removeClass("zan-on").find("i").removeClass("on")}else f.resultCode==-100?b.login():c.msg("操作失败~请稍后再试")},"json")})}}})