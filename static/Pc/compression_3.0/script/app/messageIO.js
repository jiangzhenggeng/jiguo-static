define(["require","jquery","socket.io"],function(require,$,io){function _pushNotification(userssid){var socket=io("http://io.jiguo.com:2126");socket.on("connect",function(){socket.emit("login",userssid)}),socket.on("pc-news",function(msg){eval("msg = "+msg);var tempFunc=function(a,b,c){parseInt(a)>99?html="<font>99</font>":html=a,$(b).find(">.badge").remove(),$(b).parent(".badge-number").show(),c=="tips"?$(b).each(function(){$(this).hasClass("badge-new")?$(this).append('<em class="badge badge-new-dot dot"></em>'):$(this).append('<em class="badge dot"></em>')}):$(b).each(function(){$(this).hasClass("badge-new")?$(this).append('<em class="badge number">('+html+")</em>"):$(this).append('<em class="badge number">'+html+"</em>")})};if(msg!=null){_msg=msg.data;var html=0;if(msg.type=="broadcast"){if($("[data-badge-warp]").find(">.badge").length>0)return;tempFunc(msg.tips,".systemsnews","tips"),tempFunc(msg.tips,"[data-badge-warp]","tips")}else msg.type=="news"&&(typeof _msg.event!="undefined"&&parseInt(_msg.event)>0&&tempFunc(_msg.event,".eventnews"),typeof _msg.systems!="undefined"&&parseInt(_msg.systems)>0&&tempFunc(_msg.systems,".systemsnews","tips"),typeof _msg.coin!="undefined"&&parseInt(_msg.coin)>0&&tempFunc(_msg.coin,".coinnews","tips"),typeof _msg.comment!="undefined"&&parseInt(_msg.comment)>0&&tempFunc(_msg.comment,".commentnews"),typeof _msg.zan!="undefined"&&parseInt(_msg.zan)>0&&tempFunc(_msg.zan,".zannews"));if(typeof msg.num!="undefined"&&parseInt(msg.num)>0)tempFunc(msg.num,"[data-badge-warp]");else if(typeof msg.tips!="undefined"&&parseInt(msg.tips)>0){if($("[data-badge-warp]").find(">.badge").length>0)return;tempFunc(msg.tips,"[data-badge-warp]","tips")}}})}return{init:_pushNotification}})