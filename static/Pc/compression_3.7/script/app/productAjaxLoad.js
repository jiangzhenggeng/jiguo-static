define(["require","jquery","app/unitTool","app/tplEngine","app/lazyload"],function(a,b,c,d,e){function f(a){function m(a){f.load&&(f.load=!1,h.hide(),i.show(),k.limit=f.limit,k.size=f.options.size,b.get(f.options.url,k,function(d){i.hide();var g=c.getLength(d.result);if(g){f.p++;var k=l({data:d.result});f.options.boxDom.append(k),(a||b.noop)(),f.limit=c.has(d,"limit")?d.limit:0,f.load=!0,h.show(),g<f.options.size&&(f.load=!1,h.hide(),j.show()),e.init()}else f.load=!1,j.show()},"json"))}var f=this;f.options=b.extend({url:"/api/article/GetArticleList",fireDom:".loading-more-btn",tplDom:"#loading-data-list-tpl",boxDom:"#productAjaxLoad",data:{},size:20},a);if(f.options.url==null)throw"没有URL";f.options.fireDom=b(f.options.fireDom),f.options.boxDom=b(f.options.boxDom);var g=f.options.fireDom.parent().parent(),h=b(".click-loading"),i=b(".is-loading"),j=b(".no-data");f.load=!0,f.limit=0,f.p=0;var k=b.extend({},f.options.data),l=d.init(b(f.options.tplDom).html());f.clickFirst=!1,f.options.fireDom.bind("click",function(){m(function(){f.options.fireDom.unbind("click"),b(window).scroll(function(){var a=b(document).scrollTop()+b(window).height()+400;f.load&&a>f.options.fireDom.offset().top&&m()})})}),m()}return{init:f}})