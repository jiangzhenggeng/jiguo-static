define(["require","jquery","app/unitTool","app/tplEngine","app/lazyload"],function(a,b,c,d,e){function f(a){function f(a){g.load&&(g.load=!1,i.hide(),j.show(),l.limit=g.limit,l.size=g.options.size,b.get(g.options.url,l,function(d){j.hide();var f=c.getLength(d.result);if(f){g.p++;var h=m({data:d.result});g.options.boxDom.append(h),(a||b.noop)(),g.limit=c.has(d,"limit")?d.limit:0,g.load=!0,i.show(),f<g.options.size&&(g.load=!1,i.hide(),k.show()),e.init()}else g.load=!1,k.show()},"json"))}var g=this;g.options=b.extend({url:"/api/article/GetArticleList",fireDom:".loading-more-btn",tplDom:"#loading-data-list-tpl",boxDom:"#productAjaxLoad",data:{},size:20},a);if(g.options.url==null)throw"没有URL";g.options.fireDom=b(g.options.fireDom),g.options.boxDom=b(g.options.boxDom);var h=g.options.fireDom.parent().parent(),i=b(".click-loading"),j=b(".is-loading"),k=b(".no-data");g.load=!0,g.limit=0,g.p=0;var l=b.extend({},g.options.data),m=d.init(b(g.options.tplDom).html());g.clickFirst=!1,g.options.fireDom.bind("click",function(){f(function(){g.options.fireDom.unbind("click"),b(window).scroll(function(){var a=b(document).scrollTop()+b(window).height()+400;g.load&&a>g.options.fireDom.offset().top&&f()})})}),f()}return{init:f}})