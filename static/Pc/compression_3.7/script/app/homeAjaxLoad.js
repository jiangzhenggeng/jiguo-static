function _orderCard_1(a,b){function c(a){var b=0;if(a==1)b=2;else if(a==4)b=2;else if(a==0||a==3||a==2)b=1;return b}var d=0,e=[],f=[],g=[],h=[],i=[],j=0;for(var k in a)j=c(a[k].type),j==1?e.push(a[k]):j==2?f.push(a[k]):j==3&&g.push(a[k]);var l=[];b==1?l.push(e.pop()):b==2&&(f.length>=2?l.push(f.pop()):(l.push(e.pop()),l.push(e.pop())));var m=e.length-f.length;if(m>=0)for(;f.length;)Math.random()<.5?(h.push(e.pop()),h.push(f.pop())):(h.push(f.pop()),h.push(e.pop()));else for(;e.length;)Math.random()<.5?(h.push(e.pop()),h.push(f.pop())):(h.push(f.pop()),h.push(e.pop()));var n=[];for(var k=0,o=g.length;k<o;k++){var p=Math.floor(Math.random()*h.length);p%2==0?p=p:p+=1,n.push(p)}n.sort(function(b,c){return c-b});for(var k=0,o=g.length;k<o;k++)h.splice(n[k],0,g.pop()),e.length>=3&&(h.splice(n[k]+1,0,e.pop()),h.splice(n[k]+1,0,e.pop()),h.splice(n[k]+1,0,e.pop()));if(e.length){b=3-e.length%3;for(;e.length;)h.push(e.pop())}else{b=f.length;for(;f.length;)h.push(f.pop())}for(;l.length;)h.splice(0,0,l.pop());return{data:h,prevOrderTag:b}}function _orderCard_2(a,b){function c(a){var b=0;if(a==1||a==4||a==6)b=2;else if(a==0||a==3||a==2)b=1;return b}var d=0,e=[],f=[],g=[],h=[],i=0;for(var j in a)i=c(a[j].type),i==1?e.push(a[j]):i==2&&f.push(a[j]);var k=[];b==1?k.push(e.pop()):b==2?f.length>0?k.push(f.pop()):(k.push(e.pop()),k.push(e.pop())):b==3&&(f.length>0?(k.push(f.pop()),k.push(e.pop())):(k.push(e.pop()),k.push(e.pop()),k.push(e.pop())));var l=[0,5,7,9,14,16,18,23,25,27,32,34,36,41,43,45,50,52,54];for(var j=0;f.length;j++)l[j]!=undefined?e.splice(l[j],0,f.shift()):e.push(f.shift());for(;k.length;)g.push(k.shift());for(;e.length;)g.push(e.shift());return{data:g}}function getFirstLastLiPos(a){var b=a.find(">li:last-child");if(b.length<=0)return 0;var c=b.position().left+b.width(),d=$(window).height(),e=0;return c<=265?e=3:c>265&&c<=540?e=2:c>540&&c<=830?e=1:e=0,e}define(["require","jquery","app/unitTool","app/tplEngine","app/lazyload"],function(a,b,c,d,e){function g(a){function m(a){f.load&&(f.load=!1,h.hide(),i.show(),b.get(f.options.url,{limit:f.limit,size:f.size},function(d){i.hide();var g=c.getLength(d.result);if(g){var m=_orderCard_2(d.result,l),n=k({data:m.data});f.options.boxDom.append(n),l=getFirstLastLiPos(f.options.boxDom),(a||b.noop)(),f.limit=c.has(d,"limit")?d.limit:0,f.load=!0,h.show(),g<f.size&&(f.load=!1,h.hide(),j.show()),e.init()}else f.load=!1,j.show()},"json"))}var f=this;f.options=b.extend({url:"/api/article/GetArticleList",fireDom:".loading-more-btn",tplDom:"#home-loading-data-tpl",boxDom:"#homeAjaxLoad"},a);if(f.options.url==null)throw"没有URL";f.options.fireDom=b(f.options.fireDom),f.options.boxDom=b(f.options.boxDom);var g=f.options.fireDom.parent().parent(),h=b(".click-loading"),i=b(".is-loading"),j=b(".no-data");f.load=!0,f.limit=window.indexAjaxLoadLimitDefault||0,f.size=30;var k=d.init(b(f.options.tplDom).html()),l=getFirstLastLiPos(f.options.boxDom);f.clickFirst=!1,f.options.fireDom.bind("click",function(){m(function(){f.options.fireDom.unbind("click"),b(window).bind("scrollstop scrollstart",function(){var a=b(document).scrollTop()+b(window).height()+400;f.load&&a>f.options.fireDom.offset().top&&m()})})}),m()}var f=b(window).height();return{init:g}})