define(["jquery","layer","app/tplEngine","app/provinceArea"],function(a,b,c,d){b.ready(),a(function(){function e(e){var e=a.extend({title:"添加地址",data:{},url:"/api/user/AddRess",tpl:"#add-addr-tpl"},e),f=c.init(a(e.tpl).html(),{data:e.data});b.open({type:1,title:e.title,closeBtn:1,shadeClose:!0,area:["500px","420px"],content:f,success:function(c,f){var g=a("#addrFormData");a(c).find(".btn").click(function(){if(a(c).find("#username").val()==""){b.msg("请填写姓名");return}if(a(c).find("#tel").val()==""){b.msg("请填写电话");return}if(a(c).find("#city").val()==""){b.msg("请填写省市");return}if(a(c).find("#address").val()==""){b.msg("请填写详细地址");return}if(a(c).find("#posts").val()==""){b.msg("请填写邮编");return}var d=g.serialize();a.post(e.url,d,function(a){a.resultCode==0?window.location.reload():b.msg(a.errorMsg||"系统错误")},"json")}),d.init()}})}a("[data-edit-addr]").click(function(){var c=a(this);a.get("/api/user/GetAddress",{id:c.attr("data-id")},function(a){a.resultCode!=0?b.msg("系统错误"):e({data:a.result,title:"修改地址",url:"/api/user/EditAddress",tpl:"#add-addr-edit-tpl"})},"json")}),a("[data-default-addr]").click(function(){var c=a(this);a(this).prop("checked")&&a.get("/api/user/SetAddress",{id:a(this).attr("data-id")},function(a){a.resultCode!=0&&(b.msg("系统错误"),c.prop("checked",!1))},"json")}),a("[data-delete-addr]").click(function(){var c=a(this);b.alert("您确定删除吗?",function(){a.get("/api/user/DelAddress",{id:c.attr("data-id")},function(d){d.resultCode!=0?b.msg("系统错误"):(c.parent().parent().fadeOut(250,function(){a(this).remove()}),b.closeAll())},"json")})}),a("#add-addr").click(function(){e()})})})