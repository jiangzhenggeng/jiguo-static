function _orderCard_1(a,b){function c(a){var b=0;if(a==1)b=2;else if(a==4)b=2;else if(a==0||a==3||a==2)b=1;return b}var d=0,e=[],f=[],g=[],h=[],i=[],j=0;for(var k in a)j=c(a[k].type),j==1?e.push(a[k]):j==2?f.push(a[k]):j==3&&g.push(a[k]);var l=[];b==1?l.push(e.pop()):b==2&&(f.length>=2?l.push(f.pop()):(l.push(e.pop()),l.push(e.pop())));var m=e.length-f.length;if(m>=0)for(;f.length;)Math.random()<.5?(h.push(e.pop()),h.push(f.pop())):(h.push(f.pop()),h.push(e.pop()));else for(;e.length;)Math.random()<.5?(h.push(e.pop()),h.push(f.pop())):(h.push(f.pop()),h.push(e.pop()));var n=[];for(var k=0,o=g.length;k<o;k++){var p=Math.floor(Math.random()*h.length);p%2==0?p=p:p+=1,n.push(p)}n.sort(function(a,b){return b-a});for(var k=0,o=g.length;k<o;k++)h.splice(n[k],0,g.pop()),e.length>=3&&(h.splice(n[k]+1,0,e.pop()),h.splice(n[k]+1,0,e.pop()),h.splice(n[k]+1,0,e.pop()));if(e.length){b=3-e.length%3;for(;e.length;)h.push(e.pop())}else{b=f.length;for(;f.length;)h.push(f.pop())}for(;l.length;)h.splice(0,0,l.pop());return{data:h,prevOrderTag:b}}function _orderCard_2(a,b){function c(a){var b=0;if(a==1||a==4)b=2;else if(a==0||a==3||a==2)b=1;return b}var d=0,e=[],f=[],g=[],h=[],i=0;for(var j in a)i=c(a[j].type),i==1?e.push(a[j]):i==2&&f.push(a[j]);var k=[];b==1?k.push(e.pop()):b==2?f.length>0?k.push(f.pop()):(k.push(e.pop()),k.push(e.pop())):b==3&&(f.length>0?(k.push(f.pop()),k.push(e.pop())):(k.push(e.pop()),k.push(e.pop()),k.push(e.pop())));var l=[0,5,7,9,14,16,18,23,25,27,32,34,36,41,43,45,50,52,54];for(var j=0;f.length;j++)l[j]!=undefined?e.splice(l[j],0,f.shift()):e.push(f.shift());for(;k.length;)g.push(k.shift());for(;e.length;)g.push(e.shift());return{data:g}}function getFirstLastLiPos(a){var b=a.find(">li:last-child");if(b.length<=0)return 0;var c=b.position().left+b.width(),d=$(window).height(),e=0;return d>900?c<=360?e=2:c>360&&c<=720?e=1:e=0:c<=265?e=3:c>265&&c<=540?e=2:c>540&&c<=830?e=1:e=0,e}define(["require","jquery","app/unitTool","app/tplEngine","app/lazyload"],function(a,b,c,d,e){function f(a){function f(a){g.load&&(g.load=!1,i.hide(),j.show(),b.get(g.options.url,{limit:g.limit,size:g.size},function(d){j.hide();var f=c.getLength(d.result);if(f){var h=_orderCard_2(d.result,m),n=l({data:h.data});g.options.boxDom.append(n),m=getFirstLastLiPos(g.options.boxDom),(a||b.noop)(),g.limit=c.has(d,"limit")?d.limit:0,g.load=!0,i.show(),f<g.size&&(g.load=!1,i.hide(),k.show()),e.init()}else g.load=!1,k.show()},"json"))}var g=this;g.options=b.extend({url:"/api/article/GetArticleList",fireDom:".loading-more-btn",tplDom:"#home-loading-data-tpl",boxDom:"#homeAjaxLoad"},a);if(g.options.url==null)throw"没有URL";g.options.fireDom=b(g.options.fireDom),g.options.boxDom=b(g.options.boxDom);var h=g.options.fireDom.parent().parent(),i=b(".click-loading"),j=b(".is-loading"),k=b(".no-data");g.load=!0,g.limit=window.indexAjaxLoadLimitDefault||0,g.size=30;var l=d.init(b(g.options.tplDom).html()),m=getFirstLastLiPos(g.options.boxDom);g.clickFirst=!1,g.options.fireDom.bind("click",function(){f(function(){g.options.fireDom.unbind("click"),b(window).bind("scrollstop scrollstart",function(){var a=b(document).scrollTop()+b(window).height()+400;g.load&&a>g.options.fireDom.offset().top&&f()})})}),f()}var g=b(window).height();return{init:f}})