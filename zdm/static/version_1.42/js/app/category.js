define(["jquery"],function(a){function b(c,d){var e=a("[data-category]:not([data-category-init])");e.bind("change",function(){var c=a(this),e=c.val();a.get("/admin/ajax/GetProductCategory",{parentid:e},function(a){c.nextAll("[data-category]").remove();if(a.length<=0){c.attr("name",c.attr("data-name"));return}var e='<option value="-1">选择分类</option>',f="";for(var g in a)e+='<option value="'+a[g].id+'">'+a[g].name+"</option>";var h=c.attr("name")||c.attr("data-name");e='<select class="Z-w-110" data-category name="'+h+'">'+e+"</select>",d||c.attr("data-name",h).removeAttr("name"),c.after(e),b(!0,d)},"json")}),e.attr("data-category-init","init"),c&&e.trigger("change")}function c(c,d){d=d||!1,a.get("/admin/ajax/GetAllCategory",{id:c||0},function(c){function e(b,c,h){c.nextAll("[data-category]").remove();if(b==null)return;c.attr("data-category-init","init");var i='<option value="-1">选择分类</option>',j="",k=null,l=null;h||(l=c.prev().val());for(var m in b)j="",b[m].disabled==1&&h&&(j="selected",k=b[m].child),i+="<option "+j+' value="'+b[m].id+'">'+b[m].name+"</option>";k==null&&typeof b[0].child!="undefined"&&b[0].child.length&&(k=b[0].child);var n="";if(k==null||d)n=' name="'+g+'" ';i='<select class="Z-w-110" '+n+' data-category data-name="'+g+'">'+i+"</select>",c.remove(),f.append(i),e(k,a("[data-category]",i),h)}var f=a("[data-top]:not([data-category-init])").parent(),g=a("[data-top]:not([data-category-init])").attr("name");e(c,a("[data-top]:not([data-category-init])"),!0),b(!1,d)},"json")}return{dataCategoryInit:c}})