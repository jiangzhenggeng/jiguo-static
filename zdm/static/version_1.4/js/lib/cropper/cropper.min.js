/*!
 * Cropper.js v1.1.2
 * https://github.com/fengyuanchen/cropperjs
 *
 * Copyright (c) 2015-2017 Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2017-10-18T13:27:02.189Z
 */

!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):a.Cropper=b()}(this,function(){function a(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function b(a){return"number"==typeof a&&!$(a)}function c(a){return void 0===a}function d(a){return"object"===(void 0===a?"undefined":Z(a))&&null!==a}function e(a){if(!d(a))return!1;try{var b=a.constructor,c=b.prototype;return b&&c&&_.call(c,"isPrototypeOf")}catch(a){return!1}}function f(a){return"function"==typeof a}function g(a,c){if(a&&f(c))if(Array.isArray(a)||b(a.length)){var e=a.length,g=void 0;for(g=0;g<e&&!1!==c.call(a,a[g],g,a);g+=1);}else d(a)&&Object.keys(a).forEach(function(b){c.call(a,a[b],b,a)});return a}function h(a){for(var b=arguments.length,c=Array(b>1?b-1:0),e=1;e<b;e++)c[e-1]=arguments[e];if(d(a)&&c.length>0){if(Object.assign)return Object.assign.apply(Object,[a].concat(c));c.forEach(function(b){d(b)&&Object.keys(b).forEach(function(c){a[c]=b[c]})})}return a}function i(a,b){for(var c=arguments.length,d=Array(c>2?c-2:0),e=2;e<c;e++)d[e-2]=arguments[e];return function(){for(var c=arguments.length,e=Array(c),f=0;f<c;f++)e[f]=arguments[f];return a.apply(b,d.concat(e))}}function j(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return ab.test(a)?Math.round(a*b)/b:a}function k(a,c){var d=a.style;g(c,function(a,c){bb.test(c)&&b(a)&&(a+="px"),d[c]=a})}function l(a,b){return a.classList?a.classList.contains(b):a.className.indexOf(b)>-1}function m(a,c){if(c)if(b(a.length))g(a,function(a){m(a,c)});else if(a.classList)a.classList.add(c);else{var d=a.className.trim();d?d.indexOf(c)<0&&(a.className=d+" "+c):a.className=c}}function n(a,c){c&&(b(a.length)?g(a,function(a){n(a,c)}):a.classList?a.classList.remove(c):a.className.indexOf(c)>=0&&(a.className=a.className.replace(c,"")))}function o(a,c,d){c&&(b(a.length)?g(a,function(a){o(a,c,d)}):d?m(a,c):n(a,c))}function p(a){return a.replace(cb,"$1-$2").toLowerCase()}function q(a,b){return d(a[b])?a[b]:a.dataset?a.dataset[b]:a.getAttribute("data-"+p(b))}function r(a,b,c){d(c)?a[b]=c:a.dataset?a.dataset[b]=c:a.setAttribute("data-"+p(b),c)}function s(a,b){if(d(a[b]))delete a[b];else if(a.dataset)try{delete a.dataset[b]}catch(c){a.dataset[b]=null}else a.removeAttribute("data-"+p(b))}function t(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(f(c)){var e=b.trim().split(db);e.length>1?g(e,function(b){t(a,b,c)}):(f(c.onceListener)&&delete (c=c.onceListener).onceListener,a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent&&a.detachEvent("on"+b,c))}}function u(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(f(c)){var e=b.trim().split(db);if(e.length>1)g(e,function(b){u(a,b,c)});else{if(d.once){var h=c,i=function j(){for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return t(a,b,j),h.apply(a,d)};h.onceListener=i,c=i}a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&&a.attachEvent("on"+b,c)}}}function v(a,b,d){if(a.dispatchEvent){var e=void 0;return f(Event)&&f(CustomEvent)?e=c(d)?new Event(b,{bubbles:!0,cancelable:!0}):new CustomEvent(b,{detail:d,bubbles:!0,cancelable:!0}):c(d)?(e=document.createEvent("Event")).initEvent(b,!0,!0):(e=document.createEvent("CustomEvent")).initCustomEvent(b,!0,!0,d),a.dispatchEvent(e)}return!a.fireEvent||a.fireEvent("on"+b)}function w(a){var b=document.documentElement,c=a.getBoundingClientRect();return{left:c.left+((P.scrollX||b&&b.scrollLeft||0)-(b&&b.clientLeft||0)),top:c.top+((P.scrollY||b&&b.scrollTop||0)-(b&&b.clientTop||0))}}function x(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function y(a){var b=a.match(fb);return b&&(b[1]!==eb.protocol||b[2]!==eb.hostname||b[3]!==eb.port)}function z(a){var b="timestamp="+(new Date).getTime();return a+(-1===a.indexOf("?")?"?":"&")+b}function A(a){var c=a.rotate,d=a.scaleX,e=a.scaleY,f=a.translateX,g=a.translateY,h=[];b(f)&&0!==f&&h.push("translateX("+f+"px)"),b(g)&&0!==g&&h.push("translateY("+g+"px)"),b(c)&&0!==c&&h.push("rotate("+c+"deg)"),b(d)&&1!==d&&h.push("scaleX("+d+")"),b(e)&&1!==e&&h.push("scaleY("+e+")");var i=h.length?h.join(" "):"none";return{WebkitTransform:i,msTransform:i,transform:i}}function B(a,b){if(!a.naturalWidth||hb){var c=document.createElement("img");c.onload=function(){b(c.width,c.height)},c.src=a.src}else b(a.naturalWidth,a.naturalHeight)}function C(a){var b=h({},a),c=[];return g(a,function(a,d){delete b[d],g(b,function(b){var d=Math.abs(a.startX-b.startX),e=Math.abs(a.startY-b.startY),f=Math.abs(a.endX-b.endX),g=Math.abs(a.endY-b.endY),h=Math.sqrt(d*d+e*e),i=(Math.sqrt(f*f+g*g)-h)/h;c.push(i)})}),c.sort(function(a,b){return Math.abs(a)<Math.abs(b)}),c[0]}function D(a,b){var c=a.pageX,d=a.pageY,e={endX:c,endY:d};return b?e:h({startX:c,startY:d},e)}function E(a){var b=0,c=0,d=0;return g(a,function(a){var e=a.startX,f=a.startY;b+=e,c+=f,d+=1}),b/=d,c/=d,{pageX:b,pageY:c}}function F(a){var b=a.aspectRatio,c=a.height,d=a.width,e=function(a){return ib(a)&&a>0};return e(d)&&e(c)?c*b>d?c=d/b:d=c*b:e(d)?c=d/b:e(c)&&(d=c*b),{width:d,height:c}}function G(a){var b=a.width,c=a.height,d=a.degree;if((d=Math.abs(d))%180==90)return{width:c,height:b};var e=d%90*Math.PI/180,f=Math.sin(e),g=Math.cos(e);return{width:b*g+c*f,height:b*f+c*g}}function H(b,c,d,e){var f=c.naturalWidth,g=c.naturalHeight,h=c.rotate,i=c.scaleX,k=c.scaleY,l=d.aspectRatio,m=d.naturalWidth,n=d.naturalHeight,o=e.fillColor,p=void 0===o?"transparent":o,q=e.imageSmoothingEnabled,r=void 0===q||q,s=e.imageSmoothingQuality,t=void 0===s?"low":s,u=e.maxWidth,v=void 0===u?1/0:u,w=e.maxHeight,x=void 0===w?1/0:w,y=e.minWidth,z=void 0===y?0:y,A=e.minHeight,B=void 0===A?0:A,C=document.createElement("canvas"),D=C.getContext("2d"),E=F({aspectRatio:l,width:v,height:x}),G=F({aspectRatio:l,width:z,height:B}),H=Math.min(E.width,Math.max(G.width,m)),I=Math.min(E.height,Math.max(G.height,n)),J=[-f/2,-g/2,f,g];return C.width=j(H),C.height=j(I),D.fillStyle=p,D.fillRect(0,0,H,I),D.save(),D.translate(H/2,I/2),D.rotate(h*Math.PI/180),D.scale(i,k),D.imageSmoothingEnabled=r,D.imageSmoothingQuality=t,D.drawImage.apply(D,[b].concat(a(J.map(function(a){return Math.floor(j(a))})))),D.restore(),C}function I(a,b,c){var d="",e=void 0;for(c+=b,e=b;e<c;e+=1)d+=jb(a.getUint8(e));return d}function J(a){var b=a.replace(kb,""),c=atob(b),d=new ArrayBuffer(c.length),e=new Uint8Array(d);return g(e,function(a,b){e[b]=c.charCodeAt(b)}),d}function K(a,b){var c="";return g(new Uint8Array(a),function(a){c+=jb(a)}),"data:"+b+";base64,"+btoa(c)}function L(a){var b=new DataView(a),c=void 0,d=void 0,e=void 0,f=void 0;if(255===b.getUint8(0)&&216===b.getUint8(1))for(var g=b.byteLength,h=2;h<g;){if(255===b.getUint8(h)&&225===b.getUint8(h+1)){e=h;break}h+=1}if(e){var i=e+10;if("Exif"===I(b,e+4,4)){var j=b.getUint16(i);if(((d=18761===j)||19789===j)&&42===b.getUint16(i+2,d)){var k=b.getUint32(i+4,d);k>=8&&(f=i+k)}}}if(f){var l=b.getUint16(f,d),m=void 0,n=void 0;for(n=0;n<l;n+=1)if(m=f+12*n+2,274===b.getUint16(m,d)){m+=8,c=b.getUint16(m,d),b.setUint16(m,1,d);break}}return c}function M(a){var b=0,c=1,d=1;switch(a){case 2:c=-1;break;case 3:b=-180;break;case 4:d=-1;break;case 5:b=90,d=-1;break;case 6:b=90;break;case 7:b=90,c=-1;break;case 8:b=-90}return{rotate:b,scaleX:c,scaleY:d}}function N(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function O(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var P="undefined"!=typeof window?window:{},Q="cropper-hidden",R=P.PointerEvent?"pointerdown":"touchstart mousedown",S=P.PointerEvent?"pointermove":"touchmove mousemove",T=P.PointerEvent?" pointerup pointercancel":"touchend touchcancel mouseup",U=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,V=/^data:/,W=/^data:image\/jpeg;base64,/,X=/^(img|canvas)$/i,Y={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},$=Number.isNaN||P.isNaN,_=Object.prototype.hasOwnProperty,ab=/\.\d*(?:0|9){12}\d*$/i,bb=/^(width|height|left|top|marginLeft|marginTop)$/,cb=/([a-z\d])([A-Z])/g,db=/\s+/,eb=P.location,fb=/^(https?:)\/\/([^:/?#]+):?(\d*)/i,gb=P.navigator,hb=gb&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(gb.userAgent),ib=Number.isFinite||P.isFinite,jb=String.fromCharCode,kb=/^data:.*,/,lb={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var a=this.element,b=this.options,c=this.container,d=this.cropper;m(d,Q),n(a,Q);var e={width:Math.max(c.offsetWidth,Number(b.minContainerWidth)||200),height:Math.max(c.offsetHeight,Number(b.minContainerHeight)||100)};this.containerData=e,k(d,{width:e.width,height:e.height}),m(a,Q),n(d,Q)},initCanvas:function(){var a=this.containerData,b=this.imageData,c=this.options.viewMode,d=Math.abs(b.rotate)%180==90,e=d?b.naturalHeight:b.naturalWidth,f=d?b.naturalWidth:b.naturalHeight,g=e/f,i=a.width,j=a.height;a.height*g>a.width?3===c?i=a.height*g:j=a.width/g:3===c?j=a.width/g:i=a.height*g;var k={aspectRatio:g,naturalWidth:e,naturalHeight:f,width:i,height:j};k.left=(a.width-i)/2,k.top=(a.height-j)/2,k.oldLeft=k.left,k.oldTop=k.top,this.canvasData=k,this.limited=1===c||2===c,this.limitCanvas(!0,!0),this.initialImageData=h({},b),this.initialCanvasData=h({},k)},limitCanvas:function(a,b){var c=this.options,d=this.containerData,e=this.canvasData,f=this.cropBoxData,g=c.viewMode,h=e.aspectRatio,i=this.cropped&&f;if(a){var j=Number(c.minCanvasWidth)||0,k=Number(c.minCanvasHeight)||0;g>1?(j=Math.max(j,d.width),k=Math.max(k,d.height),3===g&&(k*h>j?j=k*h:k=j/h)):g>0&&(j?j=Math.max(j,i?f.width:0):k?k=Math.max(k,i?f.height:0):i&&(j=f.width,(k=f.height)*h>j?j=k*h:k=j/h));var l=F({aspectRatio:h,width:j,height:k});j=l.width,k=l.height,e.minWidth=j,e.minHeight=k,e.maxWidth=1/0,e.maxHeight=1/0}if(b)if(g){var m=d.width-e.width,n=d.height-e.height;e.minLeft=Math.min(0,m),e.minTop=Math.min(0,n),e.maxLeft=Math.max(0,m),e.maxTop=Math.max(0,n),i&&this.limited&&(e.minLeft=Math.min(f.left,f.left+(f.width-e.width)),e.minTop=Math.min(f.top,f.top+(f.height-e.height)),e.maxLeft=f.left,e.maxTop=f.top,2===g&&(e.width>=d.width&&(e.minLeft=Math.min(0,m),e.maxLeft=Math.max(0,m)),e.height>=d.height&&(e.minTop=Math.min(0,n),e.maxTop=Math.max(0,n))))}else e.minLeft=-e.width,e.minTop=-e.height,e.maxLeft=d.width,e.maxTop=d.height},renderCanvas:function(a,b){var c=this.canvasData,d=this.imageData;if(b){var e=G({width:d.naturalWidth*Math.abs(d.scaleX),height:d.naturalHeight*Math.abs(d.scaleY),degree:d.rotate}),f=e.width,g=e.height,i=c.width*(f/c.naturalWidth),j=c.height*(g/c.naturalHeight);c.left-=(i-c.width)/2,c.top-=(j-c.height)/2,c.width=i,c.height=j,c.aspectRatio=f/g,c.naturalWidth=f,c.naturalHeight=g,this.limitCanvas(!0,!1)}(c.width>c.maxWidth||c.width<c.minWidth)&&(c.left=c.oldLeft),(c.height>c.maxHeight||c.height<c.minHeight)&&(c.top=c.oldTop),c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth),c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight),this.limitCanvas(!1,!0),c.left=Math.min(Math.max(c.left,c.minLeft),c.maxLeft),c.top=Math.min(Math.max(c.top,c.minTop),c.maxTop),c.oldLeft=c.left,c.oldTop=c.top,k(this.canvas,h({width:c.width,height:c.height},A({translateX:c.left,translateY:c.top}))),this.renderImage(a),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(a){var b=this.canvasData,c=this.imageData,d=c.naturalWidth*(b.width/b.naturalWidth),e=c.naturalHeight*(b.height/b.naturalHeight);h(c,{width:d,height:e,left:(b.width-d)/2,top:(b.height-e)/2}),k(this.image,h({width:c.width,height:c.height},A(h({translateX:c.left,translateY:c.top},c)))),a&&this.output()},initCropBox:function(){var a=this.options,b=this.canvasData,c=a.aspectRatio,d=Number(a.autoCropArea)||.8,e={width:b.width,height:b.height};c&&(b.height*c>b.width?e.height=e.width/c:e.width=e.height*c),this.cropBoxData=e,this.limitCropBox(!0,!0),e.width=Math.min(Math.max(e.width,e.minWidth),e.maxWidth),e.height=Math.min(Math.max(e.height,e.minHeight),e.maxHeight),e.width=Math.max(e.minWidth,e.width*d),e.height=Math.max(e.minHeight,e.height*d),e.left=b.left+(b.width-e.width)/2,e.top=b.top+(b.height-e.height)/2,e.oldLeft=e.left,e.oldTop=e.top,this.initialCropBoxData=h({},e)},limitCropBox:function(a,b){var c=this.options,d=this.containerData,e=this.canvasData,f=this.cropBoxData,g=this.limited,h=c.aspectRatio;if(a){var i=Number(c.minCropBoxWidth)||0,j=Number(c.minCropBoxHeight)||0,k=Math.min(d.width,g?e.width:d.width),l=Math.min(d.height,g?e.height:d.height);i=Math.min(i,d.width),j=Math.min(j,d.height),h&&(i&&j?j*h>i?j=i/h:i=j*h:i?j=i/h:j&&(i=j*h),l*h>k?l=k/h:k=l*h),f.minWidth=Math.min(i,k),f.minHeight=Math.min(j,l),f.maxWidth=k,f.maxHeight=l}b&&(g?(f.minLeft=Math.max(0,e.left),f.minTop=Math.max(0,e.top),f.maxLeft=Math.min(d.width,e.left+e.width)-f.width,f.maxTop=Math.min(d.height,e.top+e.height)-f.height):(f.minLeft=0,f.minTop=0,f.maxLeft=d.width-f.width,f.maxTop=d.height-f.height))},renderCropBox:function(){var a=this.options,b=this.containerData,c=this.cropBoxData;(c.width>c.maxWidth||c.width<c.minWidth)&&(c.left=c.oldLeft),(c.height>c.maxHeight||c.height<c.minHeight)&&(c.top=c.oldTop),c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth),c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight),this.limitCropBox(!1,!0),c.left=Math.min(Math.max(c.left,c.minLeft),c.maxLeft),c.top=Math.min(Math.max(c.top,c.minTop),c.maxTop),c.oldLeft=c.left,c.oldTop=c.top,a.movable&&a.cropBoxMovable&&r(this.face,"action",c.width>=b.width&&c.height>=b.height?"move":"all"),k(this.cropBox,h({width:c.width,height:c.height},A({translateX:c.left,translateY:c.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),this.complete&&v(this.element,"crop",this.getData())}},mb={initPreview:function(){var a=this.crossOrigin,b=this.options.preview,c=a?this.crossOriginUrl:this.url,d=document.createElement("img");if(a&&(d.crossOrigin=a),d.src=c,this.viewBox.appendChild(d),this.image2=d,b){var e=b.querySelector?[b]:document.querySelectorAll(b);this.previews=e,g(e,function(b){var d=document.createElement("img");r(b,"preview",{width:b.offsetWidth,height:b.offsetHeight,html:b.innerHTML}),a&&(d.crossOrigin=a),d.src=c,d.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',x(b),b.appendChild(d)})}},resetPreview:function(){g(this.previews,function(a){var b=q(a,"preview");k(a,{width:b.width,height:b.height}),a.innerHTML=b.html,s(a,"preview")})},preview:function(){var a=this.imageData,b=this.canvasData,c=this.cropBoxData,d=c.width,e=c.height,f=a.width,i=a.height,j=c.left-b.left-a.left,l=c.top-b.top-a.top;this.cropped&&!this.disabled&&(k(this.image2,h({width:f,height:i},A(h({translateX:-j,translateY:-l},a)))),g(this.previews,function(b){var c=q(b,"preview"),g=c.width,m=c.height,n=g,o=m,p=1;d&&(o=e*(p=g/d)),e&&o>m&&(n=d*(p=m/e),o=m),k(b,{width:n,height:o}),k(b.getElementsByTagName("img")[0],h({width:f*p,height:i*p},A(h({translateX:-j*p,translateY:-l*p},a))))}))}},nb={bind:function(){var a=this.element,b=this.options,c=this.cropper;f(b.cropstart)&&u(a,"cropstart",b.cropstart),f(b.cropmove)&&u(a,"cropmove",b.cropmove),f(b.cropend)&&u(a,"cropend",b.cropend),f(b.crop)&&u(a,"crop",b.crop),f(b.zoom)&&u(a,"zoom",b.zoom),u(c,R,this.onCropStart=i(this.cropStart,this)),b.zoomable&&b.zoomOnWheel&&u(c,"wheel mousewheel DOMMouseScroll",this.onWheel=i(this.wheel,this)),b.toggleDragModeOnDblclick&&u(c,"dblclick",this.onDblclick=i(this.dblclick,this)),u(document,S,this.onCropMove=i(this.cropMove,this)),u(document,T,this.onCropEnd=i(this.cropEnd,this)),b.responsive&&u(P,"resize",this.onResize=i(this.resize,this))},unbind:function(){var a=this.element,b=this.options,c=this.cropper;f(b.cropstart)&&t(a,"cropstart",b.cropstart),f(b.cropmove)&&t(a,"cropmove",b.cropmove),f(b.cropend)&&t(a,"cropend",b.cropend),f(b.crop)&&t(a,"crop",b.crop),f(b.zoom)&&t(a,"zoom",b.zoom),t(c,R,this.onCropStart),b.zoomable&&b.zoomOnWheel&&t(c,"wheel mousewheel DOMMouseScroll",this.onWheel),b.toggleDragModeOnDblclick&&t(c,"dblclick",this.onDblclick),t(document,S,this.onCropMove),t(document,T,this.onCropEnd),b.responsive&&t(P,"resize",this.onResize)}},ob={resize:function(){var a=this.options,b=this.container,c=this.containerData,d=Number(a.minContainerWidth)||200,e=Number(a.minContainerHeight)||100;if(!(this.disabled||c.width<=d||c.height<=e)){var f=b.offsetWidth/c.width;if(1!==f||b.offsetHeight!==c.height){var h=void 0,i=void 0;a.restore&&(h=this.getCanvasData(),i=this.getCropBoxData()),this.render(),a.restore&&(this.setCanvasData(g(h,function(a,b){h[b]=a*f})),this.setCropBoxData(g(i,function(a,b){i[b]=a*f})))}}},dblclick:function(){this.disabled||"none"===this.options.dragMode||this.setDragMode(l(this.dragBox,"cropper-crop")?"move":"crop")},wheel:function(a){var b=this,c=Number(this.options.wheelZoomRatio)||.1,d=1;this.disabled||(a.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(function(){b.wheeling=!1},50),a.deltaY?d=a.deltaY>0?1:-1:a.wheelDelta?d=-a.wheelDelta/120:a.detail&&(d=a.detail>0?1:-1),this.zoom(-d*c,a)))},cropStart:function(a){if(!this.disabled){var b=this.options,c=this.pointers,d=void 0;a.changedTouches?g(a.changedTouches,function(a){c[a.identifier]=D(a)}):c[a.pointerId||0]=D(a),d=Object.keys(c).length>1&&b.zoomable&&b.zoomOnTouch?"zoom":q(a.target,"action"),U.test(d)&&!1!==v(this.element,"cropstart",{originalEvent:a,action:d})&&(a.preventDefault(),this.action=d,this.cropping=!1,"crop"===d&&(this.cropping=!0,m(this.dragBox,"cropper-modal")))}},cropMove:function(a){var b=this.action;if(!this.disabled&&b){var c=this.pointers;a.preventDefault(),!1!==v(this.element,"cropmove",{originalEvent:a,action:b})&&(a.changedTouches?g(a.changedTouches,function(a){h(c[a.identifier],D(a,!0))}):h(c[a.pointerId||0],D(a,!0)),this.change(a))}},cropEnd:function(a){if(!this.disabled){var b=this.action,c=this.pointers;a.changedTouches?g(a.changedTouches,function(a){delete c[a.identifier]}):delete c[a.pointerId||0],b&&(a.preventDefault(),Object.keys(c).length||(this.action=""),this.cropping&&(this.cropping=!1,o(this.dragBox,"cropper-modal",this.cropped&&this.options.modal)),v(this.element,"cropend",{originalEvent:a,action:b}))}}},pb={change:function(a){var b=this.options,c=this.canvasData,d=this.containerData,e=this.cropBoxData,f=this.pointers,h=this.action,i=b.aspectRatio,j=e.left,k=e.top,l=e.width,m=e.height,o=j+l,p=k+m,q=0,r=0,s=d.width,t=d.height,u=!0,v=void 0;!i&&a.shiftKey&&(i=l&&m?l/m:1),this.limited&&(q=e.minLeft,r=e.minTop,s=q+Math.min(d.width,c.width,c.left+c.width),t=r+Math.min(d.height,c.height,c.top+c.height));var x=f[Object.keys(f)[0]],y={x:x.endX-x.startX,y:x.endY-x.startY},z=function(a){switch(a){case"e":o+y.x>s&&(y.x=s-o);break;case"w":j+y.x<q&&(y.x=q-j);break;case"n":k+y.y<r&&(y.y=r-k);break;case"s":p+y.y>t&&(y.y=t-p)}};switch(h){case"all":j+=y.x,k+=y.y;break;case"e":if(y.x>=0&&(o>=s||i&&(k<=r||p>=t))){u=!1;break}z("e"),l+=y.x,i&&(m=l/i,k-=y.x/i/2),l<0&&(h="w",l=0);break;case"n":if(y.y<=0&&(k<=r||i&&(j<=q||o>=s))){u=!1;break}z("n"),m-=y.y,k+=y.y,i&&(l=m*i,j+=y.y*i/2),m<0&&(h="s",m=0);break;case"w":if(y.x<=0&&(j<=q||i&&(k<=r||p>=t))){u=!1;break}z("w"),l-=y.x,j+=y.x,i&&(m=l/i,k+=y.x/i/2),l<0&&(h="e",l=0);break;case"s":if(y.y>=0&&(p>=t||i&&(j<=q||o>=s))){u=!1;break}z("s"),m+=y.y,i&&(l=m*i,j-=y.y*i/2),m<0&&(h="n",m=0);break;case"ne":if(i){if(y.y<=0&&(k<=r||o>=s)){u=!1;break}z("n"),m-=y.y,k+=y.y,l=m*i}else z("n"),z("e"),y.x>=0?o<s?l+=y.x:y.y<=0&&k<=r&&(u=!1):l+=y.x,y.y<=0?k>r&&(m-=y.y,k+=y.y):(m-=y.y,k+=y.y);l<0&&m<0?(h="sw",m=0,l=0):l<0?(h="nw",l=0):m<0&&(h="se",m=0);break;case"nw":if(i){if(y.y<=0&&(k<=r||j<=q)){u=!1;break}z("n"),m-=y.y,k+=y.y,l=m*i,j+=y.y*i}else z("n"),z("w"),y.x<=0?j>q?(l-=y.x,j+=y.x):y.y<=0&&k<=r&&(u=!1):(l-=y.x,j+=y.x),y.y<=0?k>r&&(m-=y.y,k+=y.y):(m-=y.y,k+=y.y);l<0&&m<0?(h="se",m=0,l=0):l<0?(h="ne",l=0):m<0&&(h="sw",m=0);break;case"sw":if(i){if(y.x<=0&&(j<=q||p>=t)){u=!1;break}z("w"),l-=y.x,j+=y.x,m=l/i}else z("s"),z("w"),y.x<=0?j>q?(l-=y.x,j+=y.x):y.y>=0&&p>=t&&(u=!1):(l-=y.x,j+=y.x),y.y>=0?p<t&&(m+=y.y):m+=y.y;l<0&&m<0?(h="ne",m=0,l=0):l<0?(h="se",l=0):m<0&&(h="nw",m=0);break;case"se":if(i){if(y.x>=0&&(o>=s||p>=t)){u=!1;break}z("e"),m=(l+=y.x)/i}else z("s"),z("e"),y.x>=0?o<s?l+=y.x:y.y>=0&&p>=t&&(u=!1):l+=y.x,y.y>=0?p<t&&(m+=y.y):m+=y.y;l<0&&m<0?(h="nw",m=0,l=0):l<0?(h="sw",l=0):m<0&&(h="ne",m=0);break;case"move":this.move(y.x,y.y),u=!1;break;case"zoom":this.zoom(C(f),a),u=!1;break;case"crop":if(!y.x||!y.y){u=!1;break}v=w(this.cropper),j=x.startX-v.left,k=x.startY-v.top,l=e.minWidth,m=e.minHeight,y.x>0?h=y.y>0?"se":"ne":y.x<0&&(j-=l,h=y.y>0?"sw":"nw"),y.y<0&&(k-=m),this.cropped||(n(this.cropBox,Q),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}u&&(e.width=l,e.height=m,e.left=j,e.top=k,this.action=h,this.renderCropBox()),g(f,function(a){a.startX=a.endX,a.startY=a.endY})}},qb={crop:function(){return this.ready&&!this.disabled&&(this.cropped||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&m(this.dragBox,"cropper-modal"),n(this.cropBox,Q)),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=h({},this.initialImageData),this.canvasData=h({},this.initialCanvasData),this.cropBoxData=h({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(h(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),n(this.dragBox,"cropper-modal"),m(this.cropBox,Q)),this},replace:function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&a&&(this.isImg&&(this.element.src=a),b?(this.url=a,this.image.src=a,this.ready&&(this.image2.src=a,g(this.previews,function(b){b.getElementsByTagName("img")[0].src=a}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.load(a))),this},enable:function(){return this.ready&&(this.disabled=!1,n(this.cropper,"cropper-disabled")),this},disable:function(){return this.ready&&(this.disabled=!0,m(this.cropper,"cropper-disabled")),this},destroy:function(){var a=this.element,b=this.image;return this.loaded?(this.isImg&&this.replaced&&(a.src=this.originalUrl),this.unbuild(),n(a,Q)):this.isImg?t(a,"load",this.onStart):b&&b.parentNode.removeChild(b),s(a,"cropper"),this},move:function(a,b){var d=this.canvasData,e=d.left,f=d.top;return this.moveTo(c(a)?a:e+Number(a),c(b)?b:f+Number(b))},moveTo:function(a){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,d=this.canvasData,e=!1;return a=Number(a),c=Number(c),this.ready&&!this.disabled&&this.options.movable&&(b(a)&&(d.left=a,e=!0),b(c)&&(d.top=c,e=!0),e&&this.renderCanvas(!0)),this},zoom:function(a,b){var c=this.canvasData;return a=Number(a),a=a<0?1/(1-a):1+a,this.zoomTo(c.width*a/c.naturalWidth,b)},zoomTo:function(a,b){var c=this.options,d=this.canvasData,e=d.width,f=d.height,g=d.naturalWidth,h=d.naturalHeight;if((a=Number(a))>=0&&this.ready&&!this.disabled&&c.zoomable){var i=g*a,j=h*a;if(!1===v(this.element,"zoom",{originalEvent:b,oldRatio:e/g,ratio:i/g}))return this;if(b){var k=this.pointers,l=w(this.cropper),m=k&&Object.keys(k).length?E(k):{pageX:b.pageX,pageY:b.pageY};d.left-=(i-e)*((m.pageX-l.left-d.left)/e),d.top-=(j-f)*((m.pageY-l.top-d.top)/f)}else d.left-=(i-e)/2,d.top-=(j-f)/2;d.width=i,d.height=j,this.renderCanvas(!0)}return this},rotate:function(a){return this.rotateTo((this.imageData.rotate||0)+Number(a))},rotateTo:function(a){return a=Number(a),b(a)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=a%360,this.renderCanvas(!0,!0)),this},scaleX:function(a){var c=this.imageData.scaleY;return this.scale(a,b(c)?c:1)},scaleY:function(a){var c=this.imageData.scaleX;return this.scale(b(c)?c:1,a)},scale:function(a){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,d=this.imageData,e=!1;return a=Number(a),c=Number(c),this.ready&&!this.disabled&&this.options.scalable&&(b(a)&&(d.scaleX=a,e=!0),b(c)&&(d.scaleY=c,e=!0),e&&this.renderCanvas(!0,!0)),this},getData:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=this.options,c=this.imageData,d=this.canvasData,e=this.cropBoxData,f=void 0;if(this.ready&&this.cropped){f={x:e.left-d.left,y:e.top-d.top,width:e.width,height:e.height};var h=c.width/c.naturalWidth;g(f,function(b,c){b/=h,f[c]=a?Math.round(b):b})}else f={x:0,y:0,width:0,height:0};return b.rotatable&&(f.rotate=c.rotate||0),b.scalable&&(f.scaleX=c.scaleX||1,f.scaleY=c.scaleY||1),f},setData:function(a){var c=this.options,d=this.imageData,g=this.canvasData,h={};if(f(a)&&(a=a.call(this.element)),this.ready&&!this.disabled&&e(a)){var i=!1;c.rotatable&&b(a.rotate)&&a.rotate!==d.rotate&&(d.rotate=a.rotate,i=!0),c.scalable&&(b(a.scaleX)&&a.scaleX!==d.scaleX&&(d.scaleX=a.scaleX,i=!0),b(a.scaleY)&&a.scaleY!==d.scaleY&&(d.scaleY=a.scaleY,i=!0)),i&&this.renderCanvas(!0,!0);var j=d.width/d.naturalWidth;b(a.x)&&(h.left=a.x*j+g.left),b(a.y)&&(h.top=a.y*j+g.top),b(a.width)&&(h.width=a.width*j),b(a.height)&&(h.height=a.height*j),this.setCropBoxData(h)}return this},getContainerData:function(){return this.ready?h({},this.containerData):{}},getImageData:function(){return this.loaded?h({},this.imageData):{}},getCanvasData:function(){var a=this.canvasData,b={};return this.ready&&g(["left","top","width","height","naturalWidth","naturalHeight"],function(c){b[c]=a[c]}),b},setCanvasData:function(a){var c=this.canvasData,d=c.aspectRatio;return f(a)&&(a=a.call(this.element)),this.ready&&!this.disabled&&e(a)&&(b(a.left)&&(c.left=a.left),b(a.top)&&(c.top=a.top),b(a.width)?(c.width=a.width,c.height=a.width/d):b(a.height)&&(c.height=a.height,c.width=a.height*d),this.renderCanvas(!0)),this},getCropBoxData:function(){var a=this.cropBoxData,b=void 0;return this.ready&&this.cropped&&(b={left:a.left,top:a.top,width:a.width,height:a.height}),b||{}},setCropBoxData:function(a){var c=this.cropBoxData,d=this.options.aspectRatio,g=void 0,h=void 0;return f(a)&&(a=a.call(this.element)),this.ready&&this.cropped&&!this.disabled&&e(a)&&(b(a.left)&&(c.left=a.left),b(a.top)&&(c.top=a.top),b(a.width)&&a.width!==c.width&&(g=!0,c.width=a.width),b(a.height)&&a.height!==c.height&&(h=!0,c.height=a.height),d&&(g?c.height=c.width/d:h&&(c.width=c.height*d)),this.renderCropBox()),this},getCroppedCanvas:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!P.HTMLCanvasElement)return null;var b=this.canvasData,c=H(this.image,this.imageData,b,a);if(!this.cropped)return c;var d=this.getData(),e=d.x,f=d.y,g=d.width,h=d.height,i=g/h,k=F({aspectRatio:i,width:a.maxWidth||1/0,height:a.maxHeight||1/0}),l=F({aspectRatio:i,width:a.minWidth||0,height:a.minHeight||0}),m=F({aspectRatio:i,width:a.width||g,height:a.height||h}),n=m.width,o=m.height;n=Math.min(k.width,Math.max(l.width,n)),o=Math.min(k.height,Math.max(l.height,o));var p=document.createElement("canvas"),q=p.getContext("2d");p.width=j(n),p.height=j(o),q.fillStyle=a.fillColor||"transparent",q.fillRect(0,0,n,o);var r=a.imageSmoothingEnabled,s=void 0===r||r,t=a.imageSmoothingQuality;q.imageSmoothingEnabled=s,t&&(q.imageSmoothingQuality=t);var u=c.width,v=c.height,w=e,x=f,y=void 0,z=void 0,A=void 0,B=void 0,C=void 0,D=void 0;w<=-g||w>u?(w=0,y=0,A=0,C=0):w<=0?(A=-w,w=0,C=y=Math.min(u,g+w)):w<=u&&(A=0,C=y=Math.min(g,u-w)),y<=0||x<=-h||x>v?(x=0,z=0,B=0,D=0):x<=0?(B=-x,x=0,D=z=Math.min(v,h+x)):x<=v&&(B=0,D=z=Math.min(h,v-x));var E=[w,x,y,z];if(C>0&&D>0){var G=n/g;E.push(A*G,B*G,C*G,D*G)}return q.drawImage.apply(q,[c].concat(N(E.map(function(a){return Math.floor(j(a))})))),p},setAspectRatio:function(a){var b=this.options;return this.disabled||c(a)||(b.aspectRatio=Math.max(0,a)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(a){var b=this.options,c=this.dragBox,d=this.face;if(this.loaded&&!this.disabled){var e="crop"===a,f=b.movable&&"move"===a;r(c,"action",a=e||f?a:"none"),o(c,"cropper-crop",e),o(c,"cropper-move",f),b.cropBoxMovable||(r(d,"action",a),o(d,"cropper-crop",e),o(d,"cropper-move",f))}return this}},rb=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),sb=P.Cropper,tb=function(){function a(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(O(this,a),!b||!X.test(b.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=b,this.options=h({},Y,e(c)&&c),this.complete=!1,this.cropped=!1,this.disabled=!1,this.isImg=!1,this.limited=!1,this.loaded=!1,this.ready=!1,this.replaced=!1,this.wheeling=!1,this.originalUrl="",this.canvasData=null,this.cropBoxData=null,this.previews=null,this.pointers={},this.init()}return rb(a,[{key:"init",value:function(){var a=this.element,b=a.tagName.toLowerCase(),c=void 0;if(!q(a,"cropper")){if(r(a,"cropper",this),"img"===b){if(this.isImg=!0,c=a.getAttribute("src")||"",this.originalUrl=c,!c)return;c=a.src}else"canvas"===b&&P.HTMLCanvasElement&&(c=a.toDataURL());this.load(c)}}},{key:"load",value:function(a){var b=this;if(a){this.url=a,this.imageData={};var c=this.element,d=this.options;if(d.checkOrientation&&P.ArrayBuffer)if(V.test(a))W.test(a)?this.read(J(a)):this.clone();else{var e=new XMLHttpRequest;e.onerror=function(){b.clone()},e.onload=function(){b.read(e.response)},d.checkCrossOrigin&&y(a)&&c.crossOrigin&&(a=z(a)),e.open("get",a),e.responseType="arraybuffer",e.withCredentials="use-credentials"===c.crossOrigin,e.send()}else this.clone()}}},{key:"read",value:function(a){var b=this.options,c=this.imageData,d=L(a),e=0,f=1,g=1;if(d>1){this.url=K(a,"image/jpeg");var h=M(d);e=h.rotate,f=h.scaleX,g=h.scaleY}b.rotatable&&(c.rotate=e),b.scalable&&(c.scaleX=f,c.scaleY=g),this.clone()}},{key:"clone",value:function(){var a=this.element,b=this.url,c=void 0,d=void 0;this.options.checkCrossOrigin&&y(b)&&((c=a.crossOrigin)?d=b:(c="anonymous",d=z(b))),this.crossOrigin=c,this.crossOriginUrl=d;var e=document.createElement("img");c&&(e.crossOrigin=c),e.src=d||b;var f=i(this.start,this),g=i(this.stop,this);this.image=e,this.onStart=f,this.onStop=g,this.isImg?a.complete?this.start():u(a,"load",f):(u(e,"load",f),u(e,"error",g),m(e,"cropper-hide"),a.parentNode.insertBefore(e,a.nextSibling))}},{key:"start",value:function(a){var b=this,c=this.isImg?this.element:this.image;a&&(t(c,"load",this.onStart),t(c,"error",this.onStop)),B(c,function(a,c){h(b.imageData,{naturalWidth:a,naturalHeight:c,aspectRatio:a/c}),b.loaded=!0,b.build()})}},{key:"stop",value:function(){var a=this.image;t(a,"load",this.onStart),t(a,"error",this.onStop),a.parentNode.removeChild(a),this.image=null}},{key:"build",value:function(){var a=this;if(this.loaded){this.ready&&this.unbuild();var b=this.element,c=this.options,d=this.image,e=b.parentNode,g=document.createElement("div");g.innerHTML='<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>';var h=g.querySelector(".cropper-container"),i=h.querySelector(".cropper-canvas"),j=h.querySelector(".cropper-drag-box"),k=h.querySelector(".cropper-crop-box"),l=k.querySelector(".cropper-face");this.container=e,this.cropper=h,this.canvas=i,this.dragBox=j,this.cropBox=k,this.viewBox=h.querySelector(".cropper-view-box"),this.face=l,i.appendChild(d),m(b,Q),e.insertBefore(h,b.nextSibling),this.isImg||n(d,"cropper-hide"),this.initPreview(),this.bind(),c.aspectRatio=Math.max(0,c.aspectRatio)||NaN,c.viewMode=Math.max(0,Math.min(3,Math.round(c.viewMode)))||0,this.cropped=c.autoCrop,c.autoCrop?c.modal&&m(j,"cropper-modal"):m(k,Q),c.guides||m(k.getElementsByClassName("cropper-dashed"),Q),c.center||m(k.getElementsByClassName("cropper-center"),Q),c.background&&m(h,"cropper-bg"),c.highlight||m(l,"cropper-invisible"),c.cropBoxMovable&&(m(l,"cropper-move"),r(l,"action","all")),c.cropBoxResizable||(m(k.getElementsByClassName("cropper-line"),Q),m(k.getElementsByClassName("cropper-point"),Q)),this.setDragMode(c.dragMode),this.render(),this.ready=!0,this.setData(c.data),this.completing=setTimeout(function(){f(c.ready)&&u(b,"ready",c.ready,{once:!0}),v(b,"ready"),v(b,"crop",a.getData()),a.complete=!0},0)}}},{key:"unbuild",value:function(){this.ready&&(this.complete||clearTimeout(this.completing),this.ready=!1,this.complete=!1,this.initialImageData=null,this.initialCanvasData=null,this.initialCropBoxData=null,this.containerData=null,this.canvasData=null,this.cropBoxData=null,this.unbind(),this.resetPreview(),this.previews=null,this.viewBox=null,this.cropBox=null,this.dragBox=null,this.canvas=null,this.container=null,this.cropper.parentNode.removeChild(this.cropper),this.cropper=null)}}],[{key:"noConflict",value:function(){return P.Cropper=sb,a}},{key:"setDefaults",value:function(a){h(Y,e(a)&&a)}}]),a}();return h(tb.prototype,lb,mb,nb,ob,pb,qb),tb})