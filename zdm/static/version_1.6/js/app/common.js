define(["jquery","layer","laydate"],function(a,b,c){function d(c,d,e,f,g){a.ajax({type:c,url:d,data:e,dataType:f||"JSON",success:function(c){if(c.success!="true")if(c.resultCode==-11)var d='<p class="tc">图片地址错误，请执行远程抓取</p>                                        <p class="tc"><button type="button" id="button" class="Z-btn Z-w-170">远程图片抓取</button></p>',e=b.open({title:"图片地址错误",scrollbar:!1,content:d,btn:!1,success:function(c,d){c.find("#button").click(function(){a("#edui26_body").trigger("click"),b.close(e)})}});else b.msg(c.errorMsg||"操作失败");else g(c)},error:function(){b.msg("操作失败")}})}function e(a){var b=a.attr("data-value"),c=a.find("span").html(),d=a.parent().parent().parent();d.find("input").val(b),d.find(".Z-select-selected").find("span").html(c),d.trigger("blur"),a.attr("data-selected",""),a.siblings("li").removeAttr("data-selected")}function f(){a("body").on("focus","[data-z-select]",function(){a(this).find(".Z-select-list").show()}),a("body").on("blur","[data-z-select]",function(){a(this).find(".Z-select-list").hide()}),a("body").on("click","[data-z-select] li",function(){e(a(this))})}function g(a,b){var d={elem:a||"#start",format:"YYYY-MM-DD hh:mm:ss",min:"1970-01-1 23:59:59",max:"2099-06-16 23:59:59",istime:!0,istoday:!1,choose:function(a){e.min=a,e.start=a}},e={elem:b||"#end",format:"YYYY-MM-DD hh:mm:ss",min:"1970-01-1 23:59:59",max:"2099-06-16 23:59:59",istime:!0,istoday:!1,choose:function(a){d.max=a}};c(d),c(e)}function h(a,c,e,f){var a=a||"您确定吗？";b.confirm(a,{bth:["确定","取消"]},function(){f?f():(b.msg("操作中",{time:999999}),d("post",c,e,"JSON",function(){b.msg("操作成功",function(){window.location.reload()})}))})}function i(a,c,d,e,f){b.open({type:1,title:a,scrollbar:!0,area:[c,d],content:e,success:f})}function j(){a("body").on("click","[data-delete]",function(){a(this).parent().remove()})}function k(c,d,e,f,g,h){var i="http://zdm.jiguo.com/admin2/ajax/upload",l=new XMLHttpRequest;l.open("POST",i),l.send(c);var m=k.cropper||"";l.onreadystatechange=function(){if(l.readyState==4&&l.status==200){var c=JSON.parse(l.responseText);if(c.success!="true")b.msg(c.errorMsg);else{a("#imgLoading").remove(),h&&(c.result.fileid=c.result.url);if(f){var i='<li><img src="'+c.result.url+'"><span data-delete>x</span><input type="hidden" name="'+e+'" value="'+c.result.fileid+'">'+m+"</li>";d.append(i)}else{var i='<li><img src="'+c.result.url+'"><span data-delete>x</span><input type="hidden" name="'+e+'" value="'+c.result.fileid+'">'+m+"</li>";d.html(i)}j(),(g||function(){})()}}}}function l(c,d,e,f){var g="http://zdm.jiguo.com/admin2/ajax/multipleupload",h=new XMLHttpRequest;h.open("POST",g),h.send(c);var i=l.cropper||"";h.onreadystatechange=function(){if(h.readyState==4&&h.status==200){var c=JSON.parse(h.responseText);if(c.success!="true")b.msg(c.errorMsg);else{for(var g=0;g<c.result.length;g++){f&&(c.result[g].fileid=c.result[g].url),a("#imgLoading").remove();var k='<li><img src="'+c.result[g].url+'"><span data-delete>x</span><input type="hidden" name="'+e+'" value="'+c.result[g].fileid+'">'+i+"</li>";d.append(k)}j()}}}}function m(b,c,d,e){var f=k.cropper=m.cropper||"";a("#"+b+"").find("input").change(function(){var b=a(this)[0].files;if(b.length<=0)return;var g='<li id="imgLoading"><img src="http://cdn.jiguo.com/p1/i/loading-icon.gif" class="img-loading">'+f+"</li>",h=a(this).parent().prev();d?h.append(g):h.html(g);var i=new FormData;i.append("file",b[0]),k(i,h,c,d,null,e)})}function n(b,c,d){var e=n.cropper||"";a("#"+b+"").find("input").change(function(){var b=this,f=a(b).parent().prev(),g=new FormData,h=a(this)[0].files;if(h.length<=0)return;a(h).each(function(b){var c='<li id="imgLoading"><img src="http://cdn.jiguo.com/p1/i/loading-icon.gif" class="img-loading">'+e+"</li>";f.append(c),g.append("file"+b,a(this)[0])}),l.cropper=e,l(g,f,c,d)})}function o(b){a("body").on("click",".Z-cover-hover",function(){a(this).closest("ul").find(".Z-cover-hover").removeClass("Z-block-red"),a(this).addClass("Z-block-red"),a(b).val(a(this).closest("li").find('input[type="hidden"]').val())})}function p(a){var b="";switch(a){case"0":b="用户";break;case"1":b="玩家";break;case"2":b="体验师";break;case"3":b="首席体验师";break;case"4":b="视频体验师";break;case"5":b="见习体验师";break;default:}return b}return{chooseType:f,setVal:e,layerTime:g,confirm:h,showBox:i,ajax:d,upImage:m,upImageMultiple:n,removeImage:j,setCover:o,upload:k,getGroupName:p}})