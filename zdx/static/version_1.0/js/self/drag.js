define(["jquery"],function(a){function b(){a("body").off("mousedown.t mouseup.t").on("mousedown.t","#right .drag-dom",function(){var b=this,c=null,d=null,e=a(b).parent().find(".drag-dom");a(this).attr("draggable",!0),a("body").off("selectstart").on("selectstart",b,function(){return!1}),a("body").off("dragstart.b dragstart.t").on("dragstart.t",b,function(e){a(b).addClass("drag-red"),c=e.target||e.srcElement,d=a(c)}),a("body").off("dragend.b dragend.t").on("dragend.t",b,function(){a(".drag-dom").removeClass("drag-red").attr("draggable",!1),c=null,d=null}),e.off("dragover.b dragover.t").on("dragover.t",function(a){a.preventDefault()}),e.off("dragenter.b dragenter.t").on("dragenter.t",function(){$this=a(this);var d=a(b).parent().find(".drag-dom").index(this);d==0?$this.before(c):$this.after(c)}),e.off("drop.b drop.t").on("drop.t",function(){c=null,d=null})}).on("mouseup.t","#right .drag-dom",function(){a(this).attr("draggable",!1)}),a("body").off("mousedown.b mouseup.b").on("mousedown.b",".Z-block-title",function(){var b=null,c=null,d=a(this).parent().parent()[0];a(d).attr("draggable",!0),a("body").off("selectstart").on("selectstart",d,function(){return!1}),a("body").off("dragstart.t dragstart.b").on("dragstart.b",d,function(e){a(d).addClass("drag-red"),b=e.target||e.srcElement,c=a(b)}),a("body").off("dragend.t dragend.b").on("dragend.b",d,function(){a(".Z-dragblock").removeClass("drag-red").attr("draggable",!1),b=null,c=null}),a("body").off("dragover.t dragover.b").on("dragover.b",".Z-dragblock",function(a){a.preventDefault()}),a("body").off("dragenter.t dragenter.b").on("dragenter.b",".Z-dragblock",function(){$this=a(this);var c=a(".Z-dragblock").index(this);c==0?$this.before(b):$this.after(b)}),a("body").off("drop.t drop.b").on("drop.b",".Z-dragblock",function(){b=null,c=null})}).on("mouseup.b",".Z-block-title",function(){a(this).attr("draggable",!1)})}return{init:b}})