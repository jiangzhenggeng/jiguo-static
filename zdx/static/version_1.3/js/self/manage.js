define(["jquery","layer","template","self/common"],function(a,b,c,d){function e(){return a("#name").val().trim().length<=0?(b.msg("请填写姓名"),a("#name").focus(),!1):a("#tel").val().trim().length<=0?(b.msg("请填写帐号"),a("#tel").focus(),!1):a("#password").val().trim().length<=0?(b.msg("请填写密码"),a("#password").focus(),!1):!0}function f(f){var g=a.extend({width:"500px",height:"200px",template:null,addurl:null,deleteurl:null,fun:null},f);a("#add").on("click",function(b){b.preventDefault();var e=a(this).data("title");d.showBox(e,g.width,g.height,c(g.template,{}),g.fun)}),a("body").off("click.send").on("click.send","#send",function(c){c.preventDefault();if(a(this).data("classify")){var f=a("#formSend").serialize();d.ajax("post",g.addurl,f,"json",function(){b.msg("操作成功",function(){b.closeAll(),window.location.reload()})})}else{if(!e())return;var f=a("#formSend").serialize();d.ajax("post",g.addurl,f,"json",function(){b.msg("操作成功",function(){b.closeAll(),window.location.reload()})})}}),a("body").off("click.edit").on("click.edit","[data-edit]",function(b){b.preventDefault();if(a(this).data("classify"))var e=a(this).parent().parent().data("name"),f=a(this).parent().parent().data("id"),h={name:e,id:f};else var i=a(this).data("title"),e=a(this).parent().parent().data("name"),j=a(this).parent().parent().data("tel"),k=a(this).parent().parent().data("id"),l=a(this).parent().parent().data("avatar"),m=a(this).parent().parent().data("motto"),h={name:e,tel:j,uid:k,avatar:l,motto:m};d.showBox(i,g.width,g.height,c(g.template,h),g.fun)}),a("body").off("click.delete").on("click.delete","[data-delete]",function(b){b.preventDefault();var c=a(this).parent().parent().data("id");c?a(this).data("classify")?d.confirm("你确定删除吗？",g.deleteurl,{id:c}):d.confirm("你确定删除吗？",g.deleteurl,{uid:c}):a(this).parent().remove()})}return{manageInit:f}})